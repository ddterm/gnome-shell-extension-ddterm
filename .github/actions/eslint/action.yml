# SPDX-FileCopyrightText: 2025 Aleksandr Mezin <mezin.alexander@gmail.com>
#
# SPDX-License-Identifier: CC0-1.0

name: Run ESLint
description: Run ESLint with SARIF report

runs:
  using: composite
  steps:
    - run: npm run-script lint:eslint -- --format "$GITHUB_ACTION_PATH/formatter.mjs" -o "$RUNNER_TEMP/eslint.sarif"
      shell: bash

    - id: env
      run: |
        echo "github_workspace=$GITHUB_WORKSPACE" >>"$GITHUB_OUTPUT"
        echo "runner_temp=$RUNNER_TEMP" >>"$GITHUB_OUTPUT"
      shell: bash
      if: always()

    - uses: github/codeql-action/upload-sarif@ce28f5bb42b7a9f2c824e633a3f6ee835bab6858 # v3.29.0
      if: always()
      with:
        sarif_file: ${{ steps.env.outputs.runner_temp }}/eslint.sarif
        checkout_path: ${{ steps.env.outputs.github_workspace }}
        category: eslint
